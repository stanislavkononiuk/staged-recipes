{% set name = "openbabel" %}
{% set version = "2.4.1" %}
{% set sha256 = "594c7f8a83f3502381469d643f7b185882da1dd4bc2280c16502ef980af2a776" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  fn: {{ name }}-{{ version }}.tar.gz
  url: https://github.com/openbabel/openbabel/archive/openbabel-{{ version|replace('.','-') }}.tar.gz
  sha256: {{ sha256 }}

  patches:
    - fix_library_path_search.diff
    - fix_data_path.diff
    - fix_babel_test_paths.diff
    - fix_python_3.6.diff  # [py3k]
    - python_link.diff

build:
  number: 0
  detect_binary_files_with_prefix: true

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - llvm    # [osx]
    - cmake
    - zlib
    - swig
    - eigen
    - bzip2
    - python
    - libxml2
    - cairo
  run:
    - python
    - libgcc  # [linux]
    - zlib
    - libxml2
    - cairo

test:
  imports:
    - openbabel
    - pybel
  commands:
    - obabel --help
    - obabel -:c1ccccc1 --gen3d -omol2
    - obabel -:c1ccccc1 --gen3d -oinchi
    - obabel -:c1ccccc1 -opng -O img.png

about:
    home: http://openbabel.org/
    license: GPLv2
    license_family: GPL
    license_file: COPYING
    summary: "A chemical toolbox designed to speak the many languages of chemical data"
    description: |
      Open Babel is a chemical toolbox designed to speak the many languages of chemical
      data. It's an open, collaborative project allowing anyone to search, convert,
      analyze, or store data from molecular modeling, chemistry, solid-state materials,
      biochemistry, or related areas.
    doc_url: http://openbabel.org/
    dev_url: https://github.com/openbabel/openbabel

extra:
  recipe-maintainers:
    - njzjz

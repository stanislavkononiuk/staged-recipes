From 27614d360f3ae505a45c067ddfb2e4273c44584a Mon Sep 17 00:00:00 2001
From: Chris Burr <christopher.burr@cern.ch>
Date: Fri, 18 Sep 2020 15:50:41 +0200
Subject: [PATCH] Check for CMAKE_GENERATOR environment variable

---
 setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/setup.py b/setup.py
index eda2450..00d79cd 100644
--- a/setup.py
+++ b/setup.py
@@ -67,7 +67,7 @@ class CMakeBuild(setuptools.command.build_ext.build_ext):
                 "-DCMAKE_LIBRARY_OUTPUT_DIRECTORY_{0}={1}".format(cfg.upper(), extdir),
                 "-DCMAKE_WINDOWS_EXPORT_ALL_SYMBOLS=TRUE",
             ]
-            if sys.maxsize > 2**32:
+            if sys.maxsize > 2**32 and os.environ.get("CMAKE_GENERATOR") != "NMake Makefiles":
                 cmake_args += ["-A", "x64"]
             # build_args += ["--", "/m"]
         else:
-- 
2.28.0


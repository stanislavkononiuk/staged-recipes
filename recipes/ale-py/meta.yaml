{% set version = "0.7.5" %}

package:
  name: ale-py
  version: {{ version }}

source:
  url: https://github.com/mgbellemare/Arcade-Learning-Environment/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 31ff9a51187a1237b683c7a5eff232b294f0bd48ca078ab57eabc9e3564ff1c1
  patches:
    # upstream avoids ninja on windows, but we don't need to
    - patches/0001-unconditionally-use-ninja.patch

build:
  number: 0
  script:
    # see https://github.com/mgbellemare/Arcade-Learning-Environment/blob/v0.7.5/setup.py#L109-L150
    - export CIBUILDWHEEL=1              # [unix]
    - set CIBUILDWHEEL=1                 # [win]
    - export GITHUB_REF="{{ version }}"  # [unix]
    - set "GITHUB_REF={{ version }}"     # [win]
    - {{ PYTHON }} -m pip install . -vv

requirements:
  build:
    - {{ compiler('cxx') }}
    - cmake
    - ninja
  host:
    - python
    - pip
    - libiconv
    - libzlib
    - sdl2
  run:
    - python
    - libiconv
    - sdl2
    # not clear where these come from, but enforced by pip checked
    - importlib-metadata
    - importlib-resources
    - numpy

test:
  imports:
    - ale_py
  requires:
    - pip
  commands:
    - pip check

about:
  home: https://github.com/mgbellemare/Arcade-Learning-Environment
  license: GPL-2.0-only
  license_family: GPL
  license_file: LICENSE.md
  summary: The Arcade Learning Environment (ALE) -- a platform for AI research.
  description: |
    The Arcade Learning Environment (ALE) is a simple framework that allows
    researchers and hobbyists to develop AI agents for Atari 2600 games.
  dev_url: https://github.com/mgbellemare/Arcade-Learning-Environment

extra:
  recipe-maintainers:
    - h-vetinari

{% set name = "smina" %}
{% set version = "2020.12.09" %}
{% set commit = "b08c07ce217d1618b51464236da0ae75971a85b9" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  # This tarball URL is not always available directly... if download fails
  # visit 1st entry on your browser so sourceforge regenerates it
  # I am listing it as a separate URL hoping is enough to trigger the generation of the actual tarball.
  - url: https://sourceforge.net/p/smina/code/ci/{{ commit }}/tarball
    # sha256: 99010f3e93aa2d20c2f8c9c83cc1633047317b41916e9f2da2e66f996fb19788
  # Make the sourceforge download artificially slow(er)
  - url: http://slowwly.robertomurray.co.uk/delay/5000/url/https://sourceforge.net/code-snapshots/git/s/sm/smina/code.git/smina-code-{{ commit }}.zip
    sha256: a2e72708fc96115f033c2a1176f2069bf4439b3d8e024c5c9675dcb5939db42a
    patches:
      - cmake.patch

build:
  number: 0
  script:
    - env GIT_HASH={{ commit }} bash {{ RECIPE_DIR }}/build_smina.sh    # [unix]
    - set GIT_HASH={{ commit }}  &&  {{ RECIPE_DIR }}\build_smina.bat   # [win]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - cmake
    - make     # [unix]
    - ninja    # [win]
  host:
    - boost-cpp
    - eigen
    - openbabel
  run:
    - boost-cpp
    - openbabel

test:
  commands:
    - smina --help
    - smina --version

about:
  home: https://sourceforge.net/projects/smina/
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE.APACHE
  summary: 'A fork of AutoDock Vina that is customized to better support scoring function development and high-performance energy minimization'
  description: |
    A fork of AutoDock Vina that is customized to better support scoring
    function development and high-performance energy minimization. smina
    is maintained by David Koes at the University of Pittsburgh and
    is not directly affiliated with the AutoDock project.
  doc_url: https://sourceforge.net/p/smina/discussion/
  dev_url: https://sourceforge.net/p/smina/code/ci/master/tree/

extra:
  recipe-maintainers:
    - jaimergp

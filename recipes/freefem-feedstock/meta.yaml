{% set name = "FreeFem" %}
{% set version = "4.10" %}
{% set sha256 = "957994c8f24cc2a671b8c116ae530796c3a431d4157ee71a3d6aab7122e7570d" %}


package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  fn: {{ name }}_{{ version }}.tar.gz
  url: https://github.com/{{ name }}/{{ name }}-sources/archive/refs/tags/v{{ version }}.tar.gz
  sha256: {{ sha256 }}

build:
  number: 0
  skip: true  # [py2k or osx or win]
  missing_dso_whitelist:
    - ffnewuoa.so
    - libhdf5.so.103

requirements:
  build:
    - cmake
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ compiler('fortran') }}
    - autoconf
    - automake
    - make
    - perl
    - unzip
    - sysroot_linux-64 =2.17    
    - libblas
    - liblapack
    - libopenblas
    - gsl
    - blis
    - freeglut
    - superlu
    - fftw
    - hdf5 {{ hdf5 }}
    - scotch {{ scotch }}
    - ipopt
    #- scalapack # requires openmpi
  host:
#    - openmpi
    - liblapack
    - bison    
    - flex    
    - python {{ python }}
    - libgomp
  run:
    - python {{ python }}  
    - {{ pin_compatible('hdf5', max_pin='x.x') }}    


about:
  home: https://freefem.org/
  license: LGPL-3.0-only
  license_family: LGPL
  license_file: LICENSE.txt
  summary: 'FreeFem : A high level multiphysics finite element software'
  description: |
    FreeFEM is a popular 2D and 3D partial differential equations (PDE) solver used by thousands of researchers across the world.
    It allows you to easily implement your own physics modules using the provided FreeFEM language. FreeFEM offers a large list of finite elements, like the Lagrange, Taylor-Hood, etc., usable in the continuous and discontinuous Galerkin method framework. 
  doc_url: https://doc.freefem.org
  dev_url: https://github.com/FreeFem

extra:
  recipe-maintainers:
    - ldallolio

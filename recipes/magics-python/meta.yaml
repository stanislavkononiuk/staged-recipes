{% set name = "magics-python" %}
{% set pypi_name = "Magics" %}
{% set version = "1.0.6" %}

package:
  name: "{{ name|lower }}"
  version: "{{ version }}"

source:
  url: https://pypi.io/packages/source/{{ pypi_name[0] }}/{{ pypi_name }}/{{ pypi_name }}-{{ version }}.tar.gz
  sha256: b852ddc368116f9a3a8d9e778e7d82eb2f086601c5ff3cc61e2ed2928812d498

build:
  number: 0
  script: "{{ PYTHON }} -m pip install . --no-deps --ignore-installed -vv "

requirements:
  host:
    - numpy
    - pip
    - python
  run:
    - numpy
    - python

test:
  # magics-python fails to import without the magics C++ library, but magics is currently built
  # with Metview enabled, which means it has Qt as a dep. conda-forge doesn't seem to mesh well
  # with the GL system package at the moment which means in order to do a simple 'import Magics'
  # test here we would need to add several CDTs and also a run_test.sh script for Linux. See the
  # magics-feedstock meta.yaml test section for an example.
  #
  # In order for magics-python to be released on PyPi it is tested thoroughly. A test here is not
  # needed, yet conda-forge requires one. In the interest of simplicity we include a dummy import
  # test.
  imports:
    - os

about:
  home: https://github.com/ecmwf/magics-python
  license: Apache 2.0
  license_family: Apache
  summary: Python interface to plot meteorological data in GRIB, NetCDF and BUFR.

extra:
  recipe-maintainers:
    - dtip

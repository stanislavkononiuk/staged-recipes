{% set version = '1.0.6' %}
{% set posix = 'm2-' if win else '' %}
{% set native = 'm2w64-' if win else '' %}

package:
  name: r-nmslibr
  version: {{ version|replace("-", "_") }}

source:
  url:
    - {{ cran_mirror }}/src/contrib/nmslibR_{{ version }}.tar.gz
    - {{ cran_mirror }}/src/contrib/Archive/nmslibR/nmslibR_{{ version }}.tar.gz
  sha256: 24412ef334ab59f2b24439de378bd9c126f1dddb8a009caf91577ecb5c542aae

build:
  merge_build_host: True  # [win]
  number: 0
  rpaths:
    - lib/R/lib/
    - lib/

requirements:
  build:
    - {{ compiler('c') }}              # [not win]
    - {{ compiler('m2w64_c') }}        # [win]
    - {{ compiler('cxx') }}            # [not win]
    - {{ compiler('m2w64_cxx') }}      # [win]
    - {{ posix }}filesystem        # [win]
    - {{ posix }}make
    - {{ posix }}sed               # [win]
    - {{ posix }}coreutils         # [win]
    - {{ posix }}zip               # [win]
    - cross-r-base {{ r_base }}    # [build_platform != target_platform]
  host:
    - r-base
    - r-kernelknn
    - r-matrix
    - r-r6
    - r-rcpp >=0.12.7
    - r-rcpparmadillo >=0.8.0
    - r-reticulate
  run:
    - r-base
    - {{ native }}gcc-libs         # [win]
    - r-kernelknn
    - r-matrix
    - r-r6
    - r-rcpp >=0.12.7
    - r-rcpparmadillo >=0.8.0
    - r-reticulate
    - python
    - numpy
    - scipy
    - nmslib

test:
  commands:
    - $R -e "library('nmslibR')"           # [not win]
    - "\"%R%\" -e \"library('nmslibR')\""  # [win]

about:
  home: https://github.com/mlampros/nmslibR
  license: Apache-2.0
  summary: A Non-Metric Space Library ('NMSLIB' <https://github.com/nmslib/nmslib>) wrapper,
    which according to the authors "is an efficient cross-platform similarity search
    library and a toolkit for evaluation of similarity search methods. The goal of the
    'NMSLIB' <https://github.com/nmslib/nmslib> Library is to create an effective and
    comprehensive toolkit for searching in generic non-metric spaces. Being comprehensive
    is important, because no single method is likely to be sufficient in all cases.
    Also note that exact solutions are hardly efficient in high dimensions and/or non-metric
    spaces. Hence, the main focus is on approximate methods". The wrapper also includes
    Approximate Kernel k-Nearest-Neighbor functions based on the 'NMSLIB' <https://github.com/nmslib/nmslib>
    'Python' Library.
  license_family: APACHE
  license_file: LICENSE.md

extra:
  recipe-maintainers:
    - conda-forge/r
    - jdblischak

# Package: nmslibR
# Type: Package
# Title: Non Metric Space (Approximate) Library
# Version: 1.0.6
# Date: 2021-09-11
# Authors@R: c( person("Lampros", "Mouselimis", email = "mouselimislampros@gmail.com", role = c("aut", "cre"), comment = c(ORCID = "https://orcid.org/0000-0002-8024-1546")), person("B.", "Naidan", role = "cph", comment = "Author of the Non-Metric Space Library (NMSLIB)"), person("L.", "Boytsov", role = "cph", comment = "Author of the Non-Metric Space Library (NMSLIB)"), person("Yu.", "Malkov", role = "cph", comment = "Author of the Non-Metric Space Library (NMSLIB)"), person("B.", "Frederickson", role = "cph", comment = "Author of the Non-Metric Space Library (NMSLIB)"), person("D.", "Novak", role = "cph", comment = "Author of the Non-Metric Space Library (NMSLIB)") )
# BugReports: https://github.com/mlampros/nmslibR/issues
# URL: https://github.com/mlampros/nmslibR
# Description: A Non-Metric Space Library ('NMSLIB' <https://github.com/nmslib/nmslib>) wrapper, which according to the authors "is an efficient cross-platform similarity search library and a toolkit for evaluation of similarity search methods. The goal of the 'NMSLIB' <https://github.com/nmslib/nmslib> Library is to create an effective and comprehensive toolkit for searching in generic non-metric spaces. Being comprehensive is important, because no single method is likely to be sufficient in all cases. Also note that exact solutions are hardly efficient in high dimensions and/or non-metric spaces. Hence, the main focus is on approximate methods". The wrapper also includes Approximate Kernel k-Nearest-Neighbor functions based on the 'NMSLIB' <https://github.com/nmslib/nmslib> 'Python' Library.
# License: Apache License (>= 2)
# SystemRequirements: python3-dev: apt-get install -y python3-dev (deb), python3-pip: apt-get install -y python3-pip (deb), numpy: pip3 install numpy (deb), scipy: pip3 install scipy (deb), nmslib: pip3 install --no-binary :all: nmslib (deb)
# Encoding: UTF-8
# Depends: R(>= 3.2.3)
# Imports: Rcpp (>= 0.12.7), reticulate, R6, Matrix, KernelKnn, utils
# LinkingTo: Rcpp, RcppArmadillo (>= 0.8.0)
# Suggests: testthat, covr, knitr, rmarkdown
# VignetteBuilder: knitr
# RoxygenNote: 7.1.1
# NeedsCompilation: yes
# Packaged: 2021-09-11 14:33:17 UTC; lampros
# Author: Lampros Mouselimis [aut, cre] (<https://orcid.org/0000-0002-8024-1546>), B. Naidan [cph] (Author of the Non-Metric Space Library (NMSLIB)), L. Boytsov [cph] (Author of the Non-Metric Space Library (NMSLIB)), Yu. Malkov [cph] (Author of the Non-Metric Space Library (NMSLIB)), B. Frederickson [cph] (Author of the Non-Metric Space Library (NMSLIB)), D. Novak [cph] (Author of the Non-Metric Space Library (NMSLIB))
# Maintainer: Lampros Mouselimis <mouselimislampros@gmail.com>
# Repository: CRAN
# Date/Publication: 2021-09-11 15:00:02 UTC

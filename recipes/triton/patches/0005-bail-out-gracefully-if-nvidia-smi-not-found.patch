From 17c78cc932ec392c9eb23a99d3919555d7d656ab Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Wed, 2 Mar 2022 13:59:15 +1100
Subject: [PATCH 5/5] bail out gracefully if nvidia-smi not found

---
 python/test/unit/runtime/test_comm.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/python/test/unit/runtime/test_comm.py b/python/test/unit/runtime/test_comm.py
index ae843a15..bbb7623a 100644
--- a/python/test/unit/runtime/test_comm.py
+++ b/python/test/unit/runtime/test_comm.py
@@ -9,7 +9,7 @@ import numpy as np
 def get_p2p_matrix():
     try:
         stdout = subprocess.check_output(["nvidia-smi", "topo", "-p2p", "n"]).decode("ascii")
-    except subprocess.CalledProcessError:
+    except (subprocess.CalledProcessError, FileNotFoundError):
         return pytest.skip("No multi-GPU topology", allow_module_level=True)
 
     lines = stdout.split("Legend")[0].split('\n')[1:]
-- 
2.35.1.windows.2


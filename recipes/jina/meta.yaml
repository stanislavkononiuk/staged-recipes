{% set name = "jina" %}
{% set version = "2.0.19" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha: 0ff0f811c5c34c5b07efbb64cfc64ef37c9d9a77d4052a49b928014e44e93c3c

build:
  number: 0

outputs:
  - name: jina-core
    build:
      entry_points:
        - jina = cli:main
        - jinad = daemon:main
      script: python -m pip install . --no-deps -vv
      script_env:
        - JINA_PIP_INSTALL_CORE=1
    test:
      requires:
        - pip
      imports:
        - jina
      commands:
        - pip check
        - jina --version
    requirements:
      host:
        - python >=3.7
        - pip
      run:
        - python >=3.7
        - protobuf >=3.13.0
        - numpy
        - tornado >=5.1.0
        - pyzmq >=17.1.0
        - pyyaml >=5.3.1
        - grpcio >=1.33.1
  - name: jina-perf
    test:
      requires:
        - pip
      imports:
        - jina
      commands:
        - pip check
        - jina --version
    build:
      entry_points:
        - jina = cli:main
        - jinad = daemon:main
      script: python -m pip install . --no-deps -vv
      script_env:
        - JINA_PIP_INSTALL_PERF=1
    requirements:
      host:
        - python >=3.7
        - pip
      run:
        - python >=3.7
        - protobuf >=3.13.0
        - numpy
        - tornado >=5.1.0
        - pyzmq >=17.1.0
        - lz4 <3.1.2
        - grpcio >=1.33.1
        - pyyaml >=5.3.1
        - uvloop
  - name: jina
    test:
      requires:
        - pip
      imports:
        - jina
      commands:
        - pip check
        - jina --version
    build:
      entry_points:
        - jina = cli:main
        - jinad = daemon:main
      script: python -m pip install . --no-deps -vv
    requirements:
      host:
        - python >=3.7
        - pip
      run:
        - python >=3.7
        - protobuf >=3.13.0
        - pyzmq >=17.1.0
        - docker-py
        - aiostream
        - python-multipart
        - cryptography
        - aiofiles
        - uvicorn >=0.14.0
        - rich
        - pydantic
        - fastapi
        - grpcio >=1.33.1
        - uvloop
        - websockets
        - numpy
        - tornado >=5.1.0
        - pyyaml >=5.3.1
        - filelock
        - requests
        - pathspec
        - aiohttp
        - lz4 <3.1.2

about:
  home: https://github.com/jina-ai/jina/
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE
  description: Jina is the cloud-native neural search framework for any kind of data
  doc_url: https://docs.jina.ai

extra:
  recipe-maintainers:
    - tadejsv
    - maateen
    - nan-wang
    - hanxiao

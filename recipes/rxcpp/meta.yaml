{% set name = "rxcpp" %}
{% set version = "4.0.0" %}
{% set sha256 = "50e7395ab1bc2a0000df126c6920a36dd3c4ee04a71496b2f4c10adf50d65178" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  fn: {{ name }}-{{ version }}.tar.gz
  url: https://github.com/Reactive-Extensions/RxCpp/archive/v{{ version }}.tar.gz
  sha256: {{ sha256 }}
  patches:
    - install-to-include.patch  # Patch is already in upstream:
    # https://github.com/Reactive-Extensions/RxCpp/commit/5b7b2a5

build:
  number: 0
  script:
    - cd projects
    - mkdir build
    - cd build
    - cmake -DCMAKE_INSTALL_PREFIX=$PREFIX -B. ../CMake
    # build a simple example to make sure everything works
    -  make println && examples/println/println     # [unix]
    - nmake rxcpp::examples::println && examples\\println\\println   # [win]
    # install the source files (since it's header-only)
    - make install

requirements:
  build:
    - cmake
    - toolchain
  # NOTE: rxcpp is header-only, so don't need to do the python dance on Windows

test:
  commands:
    - test -f $PREFIX/include/rxcpp/rx-util.hpp              # [unix]
    - if not exist %LIBRARY_INC%\\rxcpp\\rx-util.hpp exit 1  # [win]

about:
  home: https://github.com/Reactive-Extensions/RxCpp
  license: Apache-2.0
  license_family: Apache
  license_file: license.md
  summary: 'Reactive Extensions for C++'
  description: |
    The Reactive Extensions for C++ (RxCpp) is a library of algorithms for
    values-distributed-in-time. 
  doc_url: http://reactive-extensions.github.io/RxCpp/
  dev_url: https://github.com/Reactive-Extensions/RxCpp

extra:
  recipe-maintainers:
    - dougalsutherland

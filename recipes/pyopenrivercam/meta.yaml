{% set name = "pyopenrivercam" %}
{% set version = "0.2.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/localdevices/pyorc/archive/refs/tags/v0.2.0.tar.gz
  sha256: 97383d1382da61dd144dd3bc0f76323cd6c947bb682ec3a7b2455b3dae938f2c

build:
  noarch: python
  script: {{ PYTHON }} -m pip install . -vv
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - {{ cdt('mesa-libgl-devel') }}  # [linux]
    - {{ cdt('mesa-libegl-devel') }}  # [linux]
    - {{ cdt('mesa-dri-drivers') }}  # [linux]
    - {{ cdt('libselinux') }}        # [linux]
    - {{ cdt('libxdamage') }}        # [linux]
    - {{ cdt('libxfixes') }}         # [linux]
    - {{ cdt('libxxf86vm') }}        # [linux]

  run:
    - python
    - cartopy
    - descartes
    - geojson
    - geos
    - gitpython
    - jupyter
    - matplotlib
    - netCDF4
    - numpy
    - opencv
    - openpiv
    - pip
    - pyproj
    - pytest
    - rasterio
    - requests
    - scikit-image
    - scipy
    - shapely
    - tqdm
    - watermark
    - xarray
  host:
    - python
    - pip
#    - libgl1-mesa-glx
    - ffmpeg                         # [not win]
    - glib                           # [unix]
    - xorg-libxfixes
test:
  imports:
    - pyorc
  requires:
    - pip
  commands:
    - pip check

about:
  home: https://pypi.org/project/pyopenrivercam/
  summary: 'processing videos of streams into surface velocity estimates and river flow'
  description: |
    pyOpenRiverCam is an open-source API for estimating surface velocity and river flow from IP or smartphone camera
    videos. It performs preprocessing, velocimetry estimation, spurious velocity filtering, cross section sampling, 
    infilling of missings, and integration to discharge. A user only needs to perform light field work and collect 
    videos. It is pure python code.
  license: GPL-3.0-only
  license_family: GPL
  license_file: LICENSE
  doc_url: https://localdevices.github.io/pyorc
  dev_url: https://github.com/localdevices/pyorc

extra:
  recipe-maintainers:
    - hcwinsemius

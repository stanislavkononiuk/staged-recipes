{% set name = "tiled" %}
{% set version = "0.1.0a60" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/tiled-{{ version }}.tar.gz
  sha256: 32f3fee3583fe7e899d908d79319c00dd5c20bb5245c44519653c45d20cfc457

build:
  script: python -m pip install . -vv
  entry_points:
    - tiled = tiled.commandline.main:main
  number: 0

outputs:
  - name: tiled
    requirements:
      host:
        - pip
        - python
      run:
        - python
        - aiofiles
        - alembic
        - anyio
        - appdirs
        - blosc
        - cached-property  # [py<38]
        - cachetools
        - cachey
        - click !=8.1.0
        - dask
        - entrypoints
        - fastapi
        - h5netcdf
        - h5py
        - heapdict
        - httpx >=0.20.0
        - jinja2
        - jmespath
        - jsonschema
        - lz4
        - msgpack-python >=1.0.0
        - numpy
        - openpyxl
        - orjson
        - pandas
        - pillow
        - prometheus_client
        - psutil
        - pyarrow
        - pydantic >=1.8.2
        - python-dateutil
        - python-jose
        - python-multipart
        - pyyaml
        - sqlalchemy
        - tifffile
        - toolz
        - typer
        - uvicorn
        - watchgod
        - xarray
    test:
      imports:
        - tiled
        - tiled._version
        - tiled.adapters
        - tiled.adapters.array
        - tiled.adapters.dataframe
        - tiled.adapters.excel
        - tiled.adapters.files
        - tiled.adapters.hdf5
        - tiled.adapters.mapping
        - tiled.adapters.tiff
        - tiled.adapters.utils
        - tiled.adapters.xarray
        - tiled.authenticators
        - tiled.client
        - tiled.client._async_bridge
        - tiled.client.array
        - tiled.client.base
        - tiled.client.cache
        - tiled.client.constructors
        - tiled.client.context
        - tiled.client.dataframe
        - tiled.client.node
        - tiled.client.utils
        - tiled.client.xarray
        - tiled.commandline
        - tiled.commandline.main
        - tiled.config
        - tiled.database
        - tiled.database.alembic_utils
        - tiled.database.base
        - tiled.database.core
        - tiled.database.orm
        - tiled.media_type_registration
        - tiled.profiles
        - tiled.queries
        - tiled.query_registration
        - tiled.scopes
        - tiled.server
        - tiled.server.app
        - tiled.server.authentication
        - tiled.server.compression
        - tiled.server.core
        - tiled.server.dependencies
        - tiled.server.etag
        - tiled.server.object_cache
        - tiled.server.router
        - tiled.server.schemas
        - tiled.server.settings
        - tiled.server.utils
        - tiled.structures
        - tiled.structures.array
        - tiled.structures.dataframe
        - tiled.structures.image_serializer_helpers
        - tiled.structures.node
        - tiled.structures.xarray
        - tiled.utils
      commands:
        - pip check
        - tiled --help
      requires:
        - pip

  - name: tiled-array
    requirements:
      host:
        - python
      run:
        - python
        - dask
        - numpy
    test:
      imports:
        - tiled

  - name: tiled-client
    requirements:
      host:
        - python
      run:
        - python
        - appdirs
        - click !=8.1.0
        - entrypoints
        - heapdict
        - httpx >=0.20.0
        - jsonschema
        - msgpack >=1.0.0
        - pyyaml
        - typer
    test:
      imports:
        - tiled

  - name: tiled-compression
    requirements:
      host:
        - python
      run:
        - python
        - blosc
        - lz4
    test:
      imports:
        - tiled

  - name: tiled-dataframe
    requirements:
      host:
        - python
      run:
        - python
        - dask
        - pandas
        - pyarrow
    test:
      imports:
        - tiled

  - name: tiled-formats
    requirements:
      host:
        - python
      run:
        - python
        - h5py
        - h5netcdf
        - openpyxl
        - pillow
        - tifffile
    test:
      imports:
        - tiled

  - name: tiled-server
    requirements:
      host:
        - python
      run:
        - python
        - aiofiles
        - alembic
        - anyio
        - cachey
        - cached-property  # [py<38]
        - cachetools
        - click !=8.1.0
        - dask
        - fastapi
        - jinja2
        - jmespath
        - jsonschema
        - msgpack >=1.0.0
        - orjson
        - psutil
        - prometheus_client
        - pydantic >=1.8.2
        - python-dateutil
        - python-jose
        - python-multipart
        - pyyaml
        - sqlalchemy
        - toolz
        - typer
        - uvicorn
        - watchgod
    test:
      imports:
        - tiled

  - name: tiled-xarray
    requirements:
      host:
        - python
      run:
        - python
        - dask
        - pyarrow
        - xarray
    test:
      imports:
        - tiled

about:
  home: https://github.com/bluesky/tiled
  summary: Tile-based access to SciPy/PyData data structures over the web in many formats
  license: BSD-3-Clause
  license_file: LICENSE

extra:
  recipe-maintainers:
    - gbischof
    - mrakitin
    - danielballan

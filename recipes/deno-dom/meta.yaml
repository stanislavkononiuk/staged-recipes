# versions seem to all include "alpha", so I'm leaving that out. You may need to update the URL
#    below if the project stops including "alpha" on all releases.
{% set version = "0.1.23" %}

package:
  name: deno-dom
  version: {{ version }}

source:
  - url: https://github.com/b-fuze/deno-dom/archive/refs/tags/v{{ version }}-alpha-artifacts.tar.gz
    sha256: 9eeb81df4e674bb5dea1a371b0e1731b42edd81f212c395e0a25071ac16c27cd

build:
  number: 0

requirements:
  build:
    - {{ compiler("c") }}
    - {{ compiler("cxx") }}
    - cargo-bundle-licenses
    - make   # [unix]
    - rust

test:
  # TODO: make a simple test using our deno package to verify that it's working correctly
  commands:
    - test -f $PREFIX/lib/deno_dom.so                        # [linux]
    - test -f $PREFIX/lib/deno_dom.dylib                     # [osx]
    - if [ -z "$DENO_DOM_PLUGIN" ]; then echo "DENO_DOM_PLUGIN var not set correctly" && exit 1; fi                         # [unix]
    - IF NOT EXIST %LIBRARY_PREFIX%\lib\deno_dom.dll exit 1  # [win]
    - IF NOT DEFINED DENO_DOM_PLUGIN exit 1                  # [win]

about:
  home: https://github.com/b-fuze/deno-dom
  license: MIT
  license_family: MIT
  license_file:
    - LICENSE
    - DENO_DOM_THIRDPARTY_LICENSES.yml
  summary: An implementation of the browser DOM—primarily for SSR—in Deno

extra:
  recipe-maintainers:
    - msarahan
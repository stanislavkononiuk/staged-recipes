libR and GSL are not actually used, but img2px should not be
distributed because it includes GPLd code.
--- tvips/CMakeLists.txt.orig
+++ tvips/CMakeLists.txt
@@ -31,36 +31,10 @@ include(TestBigEndian)
 find_package(FLEX 2.5.34 REQUIRED)
 
 
-# XXX What version do we really need?  From
-# https://www.gnu.org/software/gsl/NEWS, it appears that
-# gsl_multimin_fdfminimizer_vector_bfgs2 was introduced in version
-# 1.9.  This may all be moot, because it seems FindGSL.cmake does not
-# actually check the version anyway.
-find_package(GSL 1.9 REQUIRED)
-if(NOT EXISTS "${GSL_CBLAS_LIB}")
-  set(GSL_CBLAS_LIB "libgslcblas.so" CACHE FILEPATH "Path to a library." FORCE)
-endif()
-mark_as_advanced(GSL_DIR)
-include_directories("${GSL_INCLUDES}")
-
-
 # Any POSIX-compliant version of iconv should be fine.
 find_package(Iconv REQUIRED)
 
 
-# Any version of libR should be fine.  Unlike find_package(),
-# pkg_check_modules() does not return the full path to shared
-# libraries, so the link directories are amended instead (see
-# https://gitlab.kitware.com/cmake/cmake/issues/15804).
-find_package(PkgConfig REQUIRED)
-pkg_check_modules(LIBR REQUIRED libR)
-include_directories(
-  "${PROJECT_SOURCE_DIR}/R"
-  "${LIBR_INCLUDE_DIRS}"
-  "/usr/share/R/include")
-link_directories("${LIBR_LIBRARY_DIRS}")
-
-
 # Any POSIX-compliant thread library should be fine.
 find_package(Threads REQUIRED)
 
@@ -339,9 +313,7 @@ add_executable(img2px
 add_dependencies(img2px _update_version_h)
 target_compile_features(img2px PRIVATE c_restrict cxx_constexpr)
 target_link_libraries(img2px
-  ${GSL_LIBRARIES}
   Iconv::Iconv
-  ${LIBR_LIBRARIES}
   ${TIFF_LIBRARIES})
 
 add_executable(img2splot

--- tvips/cmake/Modules/FindGSL.cmake
+++ /dev/null
@@ -1,36 +0,0 @@
-# From
-# https://github.com/jedbrown/cmake-modules/blob/master/FindGSL.cmake,
-# pulled 2015-07-09.
-
-# - Find GSL
-# Find the native GSL includes and library
-#
-#  GSL_INCLUDES    - where to find gsl/gsl_*.h, etc.
-#  GSL_LIBRARIES   - List of libraries when using GSL.
-#  GSL_FOUND       - True if GSL found.
-
-
-if (GSL_INCLUDES)
-  # Already in cache, be silent
-  set (GSL_FIND_QUIETLY TRUE)
-endif (GSL_INCLUDES)
-
-find_path (GSL_INCLUDES gsl/gsl_math.h)
-
-find_library (GSL_LIB NAMES gsl)
-
-set (GSL_CBLAS_LIB "" CACHE FILEPATH "If your program fails to link
-(usually because GSL is not automatically linking a CBLAS and no other
-component of your project provides a CBLAS) then you may need to point
-this variable to a valid CBLAS.  Usually GSL is distributed with
-libgslcblas.{a,so} (next to GSL_LIB) which you may use if an optimized
-CBLAS is unavailable.")
-
-set (GSL_LIBRARIES "${GSL_LIB}" "${GSL_CBLAS_LIB}")
-
-# handle the QUIETLY and REQUIRED arguments and set GSL_FOUND to TRUE if
-# all listed variables are TRUE
-include (FindPackageHandleStandardArgs)
-find_package_handle_standard_args (GSL DEFAULT_MSG GSL_LIBRARIES GSL_INCLUDES)
-
-mark_as_advanced (GSL_LIB GSL_CBLAS_LIB GSL_INCLUDES)
--- tvips/img2px.c.orig
+++ tvips/img2px.c
@@ -24,6 +24,7 @@
 
 //#define DEBUG 1
 
+#include <stdbool.h>
 #include <stdlib.h>
 
 #include <err.h>
@@ -34,8 +35,7 @@
 #include <strings.h>
 #include <unistd.h>
 
-#include <R_ext/Applic.h>
-#include <R_ext/Memory.h>
+typedef bool Rboolean;
 
 //#include <gsl/gsl_multimin.h>
 
@@ -1035,7 +1035,7 @@ _vmmin(int n0, double *b, double *Fmin, /* optimfn fminfn, optimgr fmingr, */
 
         if (gradproj < 0.0) {   /* search direction is downhill */
             steplength = 1.0;
-            accpoint = FALSE;
+            accpoint = false;
             do {
                 count = 0;
                 for (i = 0; i < n; i++) {

{% set name = "stress-ng" %}
{% set version = "0.12.04" %}

package:
  name: "{{ name|lower }}"
  version: "{{ version }}"

source:
  ## Awaiting an official upstream release incorporating the commits below.
  # url: "https://github.com/ColinIanKing/stress-ng/archive/V{{ version }}.tar.gz"
  url: https://github.com/ColinIanKing/stress-ng/archive/34044d8d13f022e17b8c80c070dcb326752f5dcc.tar.gz
  sha256: 8f8801bb9fcd02b434d4de7ea7f44594e5c8ba4e9a93ea2881c161393466ec05


build:
  number: 0
  skip: true  # [win and osx]

requirements:
  build:
    - make
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
  host:
    - libaio                    ###* libaio-dev
    - attr                      ###* libattr-dev
    - libcap                    ###* libcap-dev
    - libgcrypt                 ###* libgcrypt-dev
    - judy                      ###* judy-devel
    - keyutils-libs-cos7-s390x  ###* keyutils-libs-devel
    - libatomic_ops             ###* libatomic1
    - zlib                      ###* zlib-devel
    - make  # [unix]

test:
  commands:
    - ${BUILD_PREFIX}/stress-ng --vm 1 --vm-bytes 100M --vm-keep -t 10s

about:
  home: https://kernel.ubuntu.com/~cking/stress-ng/
  license: GPL-2.0-or-later
  license_family: GPL
  license_file: LICENSE
  summary: 'stress test a computer system in various selectable ways'
  description: |
    stress-ng will stress test a computer system in various selectable ways. It was designed to exercise various physical subsystems of a computer as well as the various operating system kernel interfaces.
  doc_url: https://wiki.ubuntu.com/Kernel/Reference/stress-ng
  dev_url: https://github.com/ColinIanKing/stress-ng

extra:
  recipe-maintainers:
    - mtekman

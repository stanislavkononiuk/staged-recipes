{% set name = "DCMTK" %}
{% set version = "3.6.7" %}
{% set SO_MAJOR = "17" %}

package:
  name: {{ name | lower }}
  version: {{ version }}

source:
  url: https://dicom.offis.de/download/dcmtk/dcmtk{{ version | replace('.','') }}/dcmtk-{{ version }}.tar.gz
  sha256: 7c58298e3e8d60232ee6fc8408cfadd14463cc11a3c4ca4c59af5988c7e9710a

build:
  number: 0
  run_exports:
    - {{ pin_subpackage(name|lower, 'x.x') }}

requirements:
  build:
    - {{ compiler('cxx') }}
    - {{ compiler('c') }}
    - cmake
    - ninja
  host:
    - openjpeg
    - libpng
    - libsndfile
    - libtiff
    - libxml2
    - openssl
    - zlib

test:
  commands:
    - dcmdump --help
    - test -f $PREFIX/include/dcmtk/ofstd/ofstd.h  # [unix]
    - test -f $PREFIX/lib/libofstd.so.{{ SO_MAJOR }}  # [linux]
    - test -f $PREFIX/lib/pkgconfig/dcmtk.pc  # [unix]
    - test -f $PREFIX/lib/cmake/dcmtk/DCMTKConfig.cmake  # [unix]

about:
  home: http://dicom.offis.de
  summary: OFFIS DICOM toolkit
  description: |
    DCMTK is a collection of libraries and applications implementing large 
    parts the DICOM standard. It includes software for examining, constructing 
    and converting DICOM image files, handling offline media, sending and 
    receiving images over a network connection, as well as demonstrative image 
    storage and worklist servers. DCMTK is is written in a mixture of ANSI C 
    and C++. 
  license: BSD-3-Clause
  license_file: COPYRIGHT
  dev_url: "https://git.dcmtk.org/"

extra:
  recipe-maintainers:
    - lamyj
